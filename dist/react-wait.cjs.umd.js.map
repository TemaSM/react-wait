{"version":3,"file":"react-wait.cjs.umd.js","sources":["../src/api.js","../src/index.js"],"sourcesContent":["export const anyWaiting = waiters => waiters.length > 0;\n\nexport const isWaiting = (waiters, waiter) => waiters.includes(waiter);\n\nexport const startWaiting = (waiters, waiter) => {\n  if (isWaiting(waiters, waiter)) return waiters;\n  return [...waiters, waiter];\n};\n\nexport const endWaiting = (waiters, waiter) => {\n  return waiters.filter(w => w !== waiter);\n};\n","import { useState, createContext, useContext } from \"react\";\nimport { anyWaiting, isWaiting, startWaiting, endWaiting } from \"./api\";\n\nconst WaitingContext = createContext();\n\nfunction Wait(props) {\n  const context = useContext(WaitingContext);\n  return context.waiters.includes(props.on) ? props.fallback : props.children;\n}\n\nexport function Waiter(props) {\n  const [waiters, setWaiters] = useState([]);\n\n  return (\n    <WaitingContext.Provider\n      value={{\n        waiters,\n        createWaitingContext: waiter => ({\n          isWaiting: () => isWaiting(waiters, waiter),\n          startWaiting: () => setWaiters(startWaiting(waiters, waiter)),\n          endWaiting: () => setWaiters(endWaiting(waiters, waiter)),\n          Wait: props => <Wait on={waiter} {...props} />\n        }),\n        anyWaiting: () => anyWaiting(waiters),\n        isWaiting: waiter => isWaiting(waiters, waiter),\n        startWaiting(waiter) {\n          setWaiters(startWaiting(waiters, waiter));\n        },\n        endWaiting(waiter) {\n          setWaiters(endWaiting(waiters, waiter));\n        }\n      }}\n    >\n      {props.children}\n    </WaitingContext.Provider>\n  );\n}\n\nexport function useWait() {\n  const context = useContext(WaitingContext);\n  return {\n    ...context,\n    Wait\n  };\n}\n"],"names":["anyWaiting","waiters","length","isWaiting","waiter","includes","startWaiting","endWaiting","filter","w","WaitingContext","createContext","Wait","props","context","useContext","on","fallback","children","Waiter","useState","setWaiters","createWaitingContext","useWait"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;EAAO,IAAMA,UAAU,GAAG,SAAbA,UAAa,CAAAC,OAAO;IAAA,OAAIA,OAAO,CAACC,MAAR,GAAiB,CAArB;EAAA,CAA1B;EAEA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACF,OAAD,EAAUG,MAAV;IAAA,OAAqBH,OAAO,CAACI,QAAR,CAAiBD,MAAjB,CAArB;EAAA,CAAlB;EAEA,IAAME,YAAY,GAAG,SAAfA,YAAe,CAACL,OAAD,EAAUG,MAAV,EAAqB;IAC/C,IAAID,SAAS,CAACF,OAAD,EAAUG,MAAV,CAAb,EAAgC,OAAOH,OAAP;IAChC,iBAAWA,OAAX,GAAoBG,MAApB;EACD,CAHM;EAKA,IAAMG,UAAU,GAAG,SAAbA,UAAa,CAACN,OAAD,EAAUG,MAAV,EAAqB;IAC7C,OAAOH,OAAO,CAACO,MAAR,CAAe,UAAAC,CAAC;MAAA,OAAIA,CAAC,KAAKL,MAAV;KAAhB,CAAP;EACD,CAFM;;ECNP,IAAMM,cAAc,gBAAGC,mBAAa,EAApC;;EAEA,SAASC,KAAT,CAAcC,KAAd,EAAqB;IACnB,IAAMC,OAAO,GAAGC,gBAAU,CAACL,cAAD,CAA1B;IACA,OAAOI,OAAO,CAACb,OAAR,CAAgBI,QAAhB,CAAyBQ,KAAK,CAACG,EAA/B,IAAqCH,KAAK,CAACI,QAA3C,GAAsDJ,KAAK,CAACK,QAAnE;EACD;;AAED,EAAO,SAASC,MAAT,CAAgBN,KAAhB,EAAuB;IAC5B,gBAA8BO,cAAQ,CAAC,EAAD,CAAtC;QAAOnB,OAAP;QAAgBoB,UAAhB;;IAEA,OACE,EAAC,cAAD,CAAgB,QAAhB;MACE,KAAK,EAAE;QACLpB,OAAO,EAAPA,OADK;QAELqB,oBAAoB,EAAE,8BAAAlB,MAAM;UAAA,OAAK;YAC/BD,SAAS,EAAE;cAAA,OAAMA,SAAS,CAACF,OAAD,EAAUG,MAAV,CAAf;aADoB;YAE/BE,YAAY,EAAE;cAAA,OAAMe,UAAU,CAACf,YAAY,CAACL,OAAD,EAAUG,MAAV,CAAb,CAAhB;aAFiB;YAG/BG,UAAU,EAAE;cAAA,OAAMc,UAAU,CAACd,UAAU,CAACN,OAAD,EAAUG,MAAV,CAAX,CAAhB;aAHmB;YAI/BQ,IAAI,EAAE,cAAAC,KAAK;cAAA,OAAI,EAAC,KAAD;gBAAM,EAAE,EAAET;iBAAYS,KAAtB,EAAJ;;WAJe;SAFvB;QAQLb,UAAU,EAAE;UAAA,OAAMA,UAAU,CAACC,OAAD,CAAhB;SARP;QASLE,SAAS,EAAE,qBAAAC,MAAM;UAAA,OAAID,SAAS,CAACF,OAAD,EAAUG,MAAV,CAAb;SATZ;QAULE,YAVK,0BAUQF,MAVR,EAUgB;UACnBiB,UAAU,CAACf,YAAY,CAACL,OAAD,EAAUG,MAAV,CAAb,CAAV;SAXG;QAaLG,UAbK,wBAaMH,MAbN,EAac;UACjBiB,UAAU,CAACd,UAAU,CAACN,OAAD,EAAUG,MAAV,CAAX,CAAV;;;OAIHS,KAAK,CAACK,QAnBT,CADF;EAuBD;AAED,EAAO,SAASK,OAAT,GAAmB;IACxB,IAAMT,OAAO,GAAGC,gBAAU,CAACL,cAAD,CAA1B;IACA,oBACKI,OADL;MAEEF,IAAI,EAAJA;;EAEH;;;;;;;;;"}